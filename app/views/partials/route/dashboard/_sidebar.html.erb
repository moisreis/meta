<%#
  # Partial: _sidebar.html
  # Date: 11/20/2025
  # Author: Moisés Reis
  # Package: Meta
  #
  # Description: Defines the main navigation sidebar for the application. It displays
  #              the user's profile avatar and provides CRUD (Create, Read, Update, Delete)
  #              navigation links for the Portfolio and User entities.
  #
  # Usage: - What: Renders the primary application sidebar navigation. It displays
  #                the user's profile avatar and includes essential CRUD links
  #                for the Portfolio and User entities.
  #        - How: Uses a sticky, full-height header with flex layout. The navigation
  #               links are dynamically generated using the `crud_nav_for` helper
  #               with localized labels and custom icons.
  #        - Why: Provides a consistent, accessible, and always-visible component
  #               for the main application navigation and identity display, ensuring
  #               quick access to core entity management.
  %>
<aside class="flex flex-col col-span-2 h-screen max-h-screen sticky overflow-y-scroll no-scrollbar top-0 [&>div]:px-6 [&>div]:flex [&>div]:flex-col [&>div]:items-start [&>div]:justify-center [&>div]:gap-1.5 bg-white border-r border-border">
  <div class="h-12 border-b border-border sticky bg-white z-50 top-0">
    <div class="flex flex-row items-center justify-between gap-1 w-full h-12">
      <%= render 'partials/modules/logo', size: "28x28" %>
      <%= link_to edit_user_registration_path,
                  class: "p-0" do
      %>
        <%= inline_svg_tag "icons/panel-right-open.svg", class: "size-3.5" %>
      <% end %>
    </div>
  </div>
  <div class="pt-6 px-3">
    <%= form_with url: "#",
                  method: :get,
                  html: { role: "presentation" } do |f| %>
      <%= render "partials/modules/input-field",
                 f: f,
                 field_type: :search_field,
                 name: :search,
                 placeholder: "Pesquisar",
                 desc: nil,
                 icon_name: "search",
                 is_inactive: false
      %>
    <% end %>
  </div>
  <div class="flex flex-col !gap-6 py-6">
    <div class="flex flex-col gap-1.5 justify-start items-start w-full">
      <%= content_tag(:h3, "Sistema", class: "text-2xs font-heading font-semibold uppercase text-muted") %>
      <div class="flex flex-col gap-1 justify-start items-start w-full">
        <%= link_to edit_user_path(current_user),
                    class: "button button-small button-ghost w-full justify-start" do
        %>
          <%= inline_svg_tag "icons/user-cog.svg" %>
          <%= content_tag :span, "Configurações" %>
        <% end %>
        <%= button_to destroy_user_session_path,
                      method: :delete,
                      data: {
                        turbo_confirm: "Tem certeza que deseja sair?"
                      },
                      class: "button button-ghost button-small w-full justify-start",
                      form: { style: "display: inline;" } do %>
          <%= inline_svg_tag "icons/log-out.svg" %>
          <%= content_tag :span, "Sair" %>
        <% end %>
      </div>
    </div>

    <%# [Navigation] Render CRUD navigation entries for Portfolio and User.
      #              Provide singular/plural labels and associated icons.
      #              Build each menu using the helper crud_nav_for.
      %>
    <%= crud_nav_for Portfolio,
                     singular: "Carteira",
                     plural: "Carteiras",
                     icons: {
                       index: "wallet.svg",
                       new: "plus.svg"
                     } %>
    <%= crud_nav_for User,
                     singular: "Usuário",
                     plural: "Usuários",
                     icons: {
                       index: "users.svg",
                       new: "plus.svg"
                     } %>
    <%= crud_nav_for InvestmentFund,
                     singular: "Fundo",
                     plural: "Fundos",
                     icons: {
                       index: "chart-pie.svg",
                       new: "plus.svg"
                     } %>
    <%= crud_nav_for FundInvestment,
                     singular: "Alocação",
                     plural: "Alocações",
                     icons: {
                       index: "badge-percent.svg",
                       new: "plus.svg"
                     } %>
    <%= crud_nav_for Application,
                     singular: "Aplicação",
                     plural: "Aplicações",
                     icons: {
                       index: "arrow-left-right.svg",
                       new: "plus.svg"
                     } %>
    <%= crud_nav_for Redemption,
                     singular: "Resgate",
                     plural: "Resgates",
                     icons: {
                       index: "circle-minus.svg",
                       new: "plus.svg"
                     } %>
    <%= crud_nav_for NormativeArticle,
                     singular: "Artigo Normativo",
                     plural: "Artigos Normativos",
                     icons: {
                       index: "scroll.svg",
                       new: "plus.svg"
                     } %>
  </div>
</aside>