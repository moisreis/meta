<%#
  # Partial: _summary-card.html.erb
  # Date: 12/01/2025
  # Author: MoisÃ©s Reis
  # Package: Meta
  #
  # Description: Defines the structure and dynamic styling for a summary card component.
  #              It calculates badge and border classes based on input booleans.
  #
  # Usage: - What: This component displays a title, an icon, a main content value, and a data badge.
  #                It adjusts the badge and border colors based on success, danger, warning, or secondary status.
  #        - How: Define the booleans (e.g., `is_success`) before rendering the partial; the main content is passed via `yield`.
  #        - Why: Provides a standardized, visually distinct card for displaying key metrics or summaries, offering immediate status feedback via color coding.
  %>

<%# [Variable] Checks if the badge should have an `outline` class.
  #            This variable defaults to true, enabling the outline style by default.
  #            It provides a visual distinction for the badge element.
  %>
<% is_outline ||= true %>

<%# [Variable] Checks if the badge should have a `success` class.
  #            This boolean determines if success (green) styling should be applied.
  #            It is used for positive status feedback.
  %>
<% is_success ||= false %>

<%# [Variable] Checks if the badge should have a `danger` class.
  #            This boolean determines if danger (red) styling should be applied.
  #            It is used for negative or critical status feedback.
  %>
<% is_danger ||= false %>

<%# [Variable] Checks if the badge should have an `alert` class (renamed to is_warning for clarity in some contexts).
  #            This boolean determines if warning (yellow/orange) styling should be applied.
  #            It is used for cautionary status feedback.
  %>
<% is_warning ||= false %>

<%# [Variable] Checks if the badge should have a `secondary` class.
  #            This boolean determines if secondary (neutral) styling should be applied.
  #            It is used for general or non-critical status feedback.
  %>
<% is_secondary ||= false %>

<%# [Variable] Defines the CSS classes for the badge.
  #            It conditionally appends color and outline classes based on the boolean flags.
  #            The `.compact.join(" ")` method ensures only defined classes are included.
  %>
<% badge_classes = [
  "badge",
  ("badge-outline" if is_outline),
  ("badge-success" if is_success),
  ("badge-danger" if is_danger),
  ("badge-alert" if is_warning),
  ("badge-secondary" if is_secondary),
].compact.join(" ") %>

<%# [Variable] Defines the dynamic border color class for the main card container.
  #            Maps the status booleans to their corresponding 'border-*-200' class.
  #            If no status is specified, it defaults to the general border color.
  %>
<% border_color_class =
     if is_success
       "border-success-200"
     elsif is_danger
       "border-danger-200"
     elsif is_warning
       "border-alert-200"
     elsif is_secondary
       "border-secondary-200"
     else
       "border-border"
     end
%>

<%# [Variable] Defines the CSS classes for the icon wrapper background and border.
  #            It selects a bright background and a light border color based on the status booleans.
  #            This creates a distinct visual circle around the icon.
  %>
<% icon_wrapper_class =
     if is_success
       "border-success-100 bg-success-600"
     elsif is_danger
       "border-danger-100 bg-danger-600"
     elsif is_warning
       "border-alert-100 bg-alert-600"
     elsif is_secondary
       "border-secondary-100 bg-secondary-600"
     else
       "border-border bg-table-bg"
     end
%>

<%# [Variable] Defines the CSS stroke color for the icon SVG itself.
  #            It selects a very light stroke color (e.g., '-50') to contrast with the dark wrapper background.
  #            This ensures the icon is highly visible inside its wrapper.
  %>
<% icon_class =
     if is_success
       "stroke-success-50"
     elsif is_danger
       "stroke-danger-50"
     elsif is_warning
       "stroke-alert-50"
     elsif is_secondary
       "stroke-secondary-50"
     else
       "stroke-body"
     end
%>

<%# [Variable] Defines the CSS text color for the badge content.
  #            It selects a darker text color (e.g., '-700') for readability inside the badge.
  #            This maintains color consistency across the card elements.
  %>
<% text_class =
     if is_success
       "text-success-700"
     elsif is_danger
       "text-danger-700"
     elsif is_warning
       "text-alert-700"
     elsif is_secondary
       "text-secondary-700"
     else
       "text-body"
     end
%>

<div class="<%= border_color_class %> border shadow-xs rounded-base p-6 h-44 flex flex-col gap-3 justify-between items-start">
  <div class="flex flex-row justify-between items-center w-full">
    <%= content_tag :h3, card_title, class: "text-muted font-heading text-body" %>
    <div class="p-3 rounded-full <%= icon_wrapper_class %>">
      <%= inline_svg_tag("icons/#{card_icon}.svg", class: "#{ icon_class } size-4") %>
    </div>
  </div>
  <div class="flex flex-col gap-1.5">
    <div class="text-2xl font-bold font-mono line-clamp-1">
      <%= yield %>
    </div>
    <div class="<%= badge_classes %>">
      <%= inline_svg_tag("icons/#{card_data_icon}.svg") %>
      <%= content_tag :p, card_data %>
    </div>
  </div>
</div>