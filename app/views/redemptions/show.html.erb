<%#
  # Partial: show.html.erb
  # Date: 11/28/2025
  # Author: Moisés Reis
  # Package: Meta
  #
  # Description: Displays a detailed view of a single redemption transaction, covering financial values,
  #              linked investment details, transaction lifecycle dates, and FIFO allocation breakdown.
  #
  # Usage: - What: Renders the comprehensive detail page for a specific investment redemption record.
  #                It allows administrators or portfolio managers to audit the withdrawal transaction.
  #        - How: This partial is rendered from the RedemptionsController#show action, receiving the @redemption
  #               instance variable, which represents the complete redemption record.
  #        - Why: Provides a single source of truth for all data points related to a withdrawal, including
  #               performance metrics, date validations, and allocation analysis.
%>

<%# Explanation:: This layout wrapper organizes the entire page content into a clean
  #               dashboard structure. It identifies the redemption by ID and shows
  #               which fund the withdrawal came from for clear context.
  %>
<%= render 'partials/route/dashboard/wrapper',
           page_title: "Resgate ##{@redemption.id}",
           page_desc: "Retirada de #{@redemption.fund_investment.investment_fund.fund_name}",
           current_view: "show" do
%>

  <%# Explanation:: This logic block calculates financial performance and FIFO metrics
    #               before the page renders. It processes yield, percentage returns,
    #               and validation states to ensure data consistency across all cards.
    %>
  <%
    yield_value = @redemption.redemption_yield || 0
    is_profit = yield_value > 0
    is_loss = yield_value < 0
    return_pct = @redemption.return_percentage
    has_return = return_pct && return_pct != 0
    positive_return = has_return && return_pct > 0
    processing_days = if @redemption.request_date && @redemption.liquidation_date
                        (@redemption.liquidation_date - @redemption.request_date).to_i
                      else
                        nil
                      end
    allocated_total = @redemption.total_allocated_quotas
    redeemed_total = @redemption.redeemed_quotas || 0
    allocation_by_app = @redemption.redemption_allocations.map do |alloc|
      app_label = "App ##{alloc.application.id} (#{alloc.application.request_date.strftime('%d/%m/%Y')})"
      [app_label, alloc.quotas_used]
    end.to_h
    total_invested = @redemption.redemption_allocations.sum do |alloc|
      alloc.quotas_used * alloc.application.quota_value_at_application
    end
    redeemed_value = @redemption.redeemed_liquid_value || 0
    net_gain = redeemed_value - total_invested
    avg_quota_cost = total_invested > 0 && @redemption.redeemed_quotas ?
                       (total_invested / @redemption.redeemed_quotas) : 0
    appreciation = if @redemption.effective_quota_value && avg_quota_cost > 0
                     ((@redemption.effective_quota_value - avg_quota_cost) / avg_quota_cost * 100)
                   else
                     nil
                   end
    cotization_valid = !@redemption.cotization_date ||
                       !@redemption.request_date ||
                       @redemption.cotization_date >= @redemption.request_date
    liquidation_valid = !@redemption.liquidation_date ||
                        !@redemption.cotization_date ||
                        @redemption.liquidation_date >= @redemption.cotization_date
    allocations_balanced = @redemption.allocations_balanced?
    sufficient_quotas = @redemption.redeemed_quotas &&
                        @redemption.fund_investment.total_quotas_held &&
                        @redemption.redeemed_quotas <= @redemption.fund_investment.total_quotas_held
  %>

  <%# Explanation:: This section groups the core administrative details of the transaction,
    #               linking it to the specific fund and portfolio. It renders first to
    #               help users quickly identify which financial asset is being modified.
    %>
  <%= render "partials/route/dashboard/section",
             section_title: "Informações do Resgate",
             section_desc: "Dados da transação de retirada",
             columns: 4,
             has_action: true,
             button_route: edit_redemption_path(@redemption),
             button_name: "Editar",
             button_icon: "pencil" do
  %>

    <%# Explanation:: This card displays the investment fund name as a clickable link
      #               to provide direct navigation to the asset details. It identifies
      #               the source of the capital for clear auditing and context.
      %>
    <%= render "partials/route/dashboard/card",
               card_title: "Fundo de Investimento",
               card_icon: "building-2" do
    %>
      <%= link_to @redemption.fund_investment.investment_fund.fund_name,
                  investment_fund_path(@redemption.fund_investment.investment_fund),
                  class: "hover:underline" %>
    <% end %>

    <%# Explanation:: This card identifies the specific portfolio owning the asset by
      #               displaying its primary name. It helps track asset ownership and
      #               provides a direct shortcut to the portfolio management screen.
      %>
    <%= render "partials/route/dashboard/card",
               card_title: "Portfólio",
               card_icon: "wallet" do
    %>
      <%= link_to @redemption.fund_investment.portfolio.name,
                  portfolio_path(@redemption.fund_investment.portfolio),
                  class: "hover:underline" %>
    <% end %>

    <%# Explanation:: This card shows the link between this redemption and its parent
      #               investment allocation. It allows users to see how this withdrawal
      #               affects the overall strategy and percentage of the total fund.
      %>
    <%= render "partials/route/dashboard/card",
               card_title: "Investimento Relacionado",
               card_icon: "link",
               card_data: "#{number_with_precision(@redemption.fund_investment.percentage_allocation, precision: 2)}%",
               card_data_icon: "percent" do
    %>
      <%= link_to "FundInvestment ##{@redemption.fund_investment.id}",
                  fund_investment_path(@redemption.fund_investment),
                  class: "hover:underline" %>
    <% end %>

    <%# Explanation:: This card displays the current operational state of the redemption
      #               using color-coded labels. It informs the user if the withdrawal
      #               is finalized or still waiting for settlement processing.
      %>
    <%= render "partials/route/dashboard/card",
               card_title: "Status do Resgate",
               card_icon: @redemption.completed? ? "check" : "clock",
               card_data: @redemption.completed? ? "Finalizado" : "Em processamento",
               card_data_icon: @redemption.completed? ? "check" : "x",
               is_success: @redemption.completed?,
               is_warning: !@redemption.completed? do
    %>
      <%= @redemption.completed? ? "Completo" : "Pendente" %>
    <% end %>
  <% end %>

  <%# Explanation:: This section aggregates all currency-based values and quota quantities
    #               into a single financial summary. It provides transparency on the
    #               monetary totals and the resulting profit or loss of the operation.
    %>
  <%= render "partials/route/dashboard/section",
             section_title: "Valores Financeiros",
             section_desc: "Montantes e rendimentos do resgate",
             columns: 4 do
  %>

    <%# Explanation:: This card presents the total cash amount received by the user after
      #               all settlement steps. It represents the liquid value of the
      #               transaction and serves as the primary financial result.
      %>
    <%= render "partials/route/dashboard/card",
               card_title: "Valor Líquido Resgatado",
               card_icon: "banknote" do
    %>
      <%= standard_currency(@redemption.redeemed_liquid_value) %>
    <% end %>

    <%# Explanation:: This card displays the quantity of fund units removed from the
      #               portfolio during this withdrawal. It tracks the exact reduction
      #               in ownership units to maintain an accurate account balance.
      %>
    <%= render "partials/route/dashboard/card",
               card_title: "Cotas Resgatadas",
               card_icon: "coins" do
    %>
      <%= @redemption.redeemed_quotas ? number_with_precision(@redemption.redeemed_quotas, precision: 4) : "N/A" %>
    <% end %>

    <%# Explanation:: This card shows the market price per quota at the exact moment of
      #               the redemption. It ensures the user knows the valuation used
      #               to convert their units back into liquid currency.
      %>
    <%= render "partials/route/dashboard/card",
               card_title: "Valor Efetivo da Cota",
               card_icon: "chart-line" do
    %>
      <%= @redemption.effective_quota_value ? standard_currency(@redemption.effective_quota_value) : "N/A" %>
    <% end %>

    <%# Explanation:: This card identifies the net financial gain or loss resulting from
      #               the withdrawal. It uses dynamic icons and colors to show if
      #               the investment yielded a profit or a deficit for the user.
      %>
    <%= render "partials/route/dashboard/card",
               card_title: "Rendimento do Resgate",
               card_icon: is_profit ? "smile" : (is_loss ? "frown" : "minus"),
               card_data: is_profit ? "Lucro" : (is_loss ? "Prejuízo" : "Neutro"),
               card_data_icon: is_profit ? "trending-up" : (is_loss ? "trending-down" : "minus"),
               is_success: is_profit,
               is_danger: is_loss do
    %>
      <%= is_profit ? '+' : '' %><%= standard_currency(yield_value.abs) %>
    <% end %>
  <% end %>

  <%# Explanation:: This section classifies the redemption based on its internal rules
    #               and percentage performance. it helps the user understand the
    #               efficiency of the withdrawal compared to the initial investment.
    %>
  <%= render "partials/route/dashboard/section",
             section_title: "Tipo e Classificação",
             section_desc: "Categoria e características do resgate",
             columns: 4 do
  %>

    <%# Explanation:: This card displays the specific category assigned to this withdrawal
      #               operation. It clarifies if the redemption was partial or total,
      #               helping the user understand the administrative nature of the record.
      %>
    <%= render "partials/route/dashboard/card",
               card_title: "Tipo de Resgate",
               card_icon: "tag" do
    %>
      <%= @redemption.redemption_type&.capitalize || "Não especificado" %>
    <% end %>

    <%# Explanation:: This card calculates the percentage yield of the withdrawal relative
      #               to the cost. It provides a relative performance metric so the
      #               user can see the growth or decline of their capital.
      %>
    <%= render "partials/route/dashboard/card",
               card_title: "Percentual de Retorno",
               card_icon: "percent",
               card_data: has_return ? (positive_return ? "Rentável" : "Prejuízo") : "N/A",
               card_data_icon: has_return ? (positive_return ? "trending-up" : "trending-down") : "minus",
               is_success: positive_return,
               is_danger: has_return && !positive_return do
    %>
      <%= return_pct ? "#{positive_return ? '+' : ''}#{number_with_precision(return_pct, precision: 2)}%" : "N/A" %>
    <% end %>

    <%# Explanation:: This card counts how many separate investment applications were
      #               linked to this single withdrawal. It reveals the complexity of
      #               the operation by showing which original entries were liquidated.
      %>
    <%= render "partials/route/dashboard/card",
               card_title: "Aplicações Vinculadas",
               card_icon: "git-branch" do
    %>
      <%= @redemption.redemption_allocations.count %> aplicações
    <% end %>

    <%# Explanation:: This card verifies that the quotas distributed across applications
      #               match the total requested. It serves as an internal check to
      #               ensure the withdrawal math remains perfectly balanced and logical.
      %>
    <%= render "partials/route/dashboard/card",
               card_title: "Balanço de Alocações",
               card_icon: @redemption.allocations_balanced? ? "scale" : "alert-square",
               card_data: @redemption.allocations_balanced? ? "Balanceado" : "Verificar",
               card_data_icon: @redemption.allocations_balanced? ? "check" : "x",
               is_success: @redemption.allocations_balanced?,
               is_warning: !@redemption.allocations_balanced? do
    %>
      <%= @redemption.allocations_balanced? ? "Ok!" : "Divergente" %>
    <% end %>
  <% end %>

  <%# Explanation:: This section tracks the chronological progress of the withdrawal
    #               from the initial request to the final settlement. It provides
    #               a timeline to monitor the operational speed of the fund manager.
    %>
  <%= render "partials/route/dashboard/section",
             section_title: "Ciclo de Vida da Transação",
             section_desc: "Datas e etapas do processo de resgate",
             columns: 4 do
  %>

    <%# Explanation:: This card records the exact date the user submitted their withdrawal
      #               request. It marks the formal beginning of the transaction and
      #               serves as the baseline for calculating total processing time.
      %>
    <%= render "partials/route/dashboard/card",
               card_title: "Data de Solicitação",
               card_icon: "calendar-plus",
               is_danger: true do
    %>
      <%= formatted_timestamp(@redemption.request_date) %>
    <% end %>

    <%# Explanation:: This card shows when the quota value was officially assigned to
      #               the redemption. It confirms the day the price was fixed and
      #               calculates how much time has passed since that calculation.
      %>
    <%= render "partials/route/dashboard/card",
               card_title: "Data de Cotização",
               card_icon: "calendar-check-2",
               card_data: @redemption.cotization_date ? "Há #{time_ago_in_words(@redemption.cotization_date)}" : "Não cotizado",
               card_data_icon: @redemption.cotization_date ? "check" : "x" do
    %>
      <%= @redemption.cotization_date ? formatted_timestamp(@redemption.cotization_date) : "N/A" %>
    <% end %>

    <%# Explanation:: This card displays the final date when the cash was moved to
      #               the user's account. It indicates that the transaction is
      #               closed and the financial cycle has reached its conclusion.
      %>
    <%= render "partials/route/dashboard/card",
               card_title: "Data de Liquidação",
               card_icon: "calendar-check-2",
               card_data: @redemption.liquidation_date ? "Há #{time_ago_in_words(@redemption.liquidation_date)}" : "Não liquidado",
               card_data_icon: @redemption.liquidation_date ? "check" : "x",
               is_success: @redemption.liquidation_date.present? do
    %>
      <%= @redemption.liquidation_date ? formatted_timestamp(@redemption.liquidation_date) : "N/A" %>
    <% end %>

    <%# Explanation:: This card calculates the number of days elapsed between the request
      #               and the final settlement. It helps the user monitor the efficiency
      #               and performance of the financial institution's processing speed.
      %>
    <%= render "partials/route/dashboard/card",
               card_title: "Tempo de Processamento",
               card_icon: "hourglass" do
    %>
      <%= processing_days ? "#{processing_days} dias" : "Calculando..." %>
    <% end %>
  <% end %>

  <%# Explanation:: This section visualizes how quotas were pulled from the oldest
    #               investments first using FIFO logic. It uses graphs to simplify
    #               the complex breakdown of unit distribution across the portfolio.
    %>
  <%= render "partials/route/dashboard/section",
             section_title: "Análise de Alocação FIFO",
             section_desc: "Distribuição de cotas entre aplicações originais",
             columns: 2 do
  %>

    <%# Explanation:: This column chart compares the quotas actually allocated against the
      #               total amount expected. It provides a visual check to confirm
      #               the system correctly balanced the units for this withdrawal.
      %>
    <%= render "partials/groups/chart-list",
               chart_type: :column_chart,
               data_source: {
                 "Alocadas" => allocated_total,
                 "Esperadas" => redeemed_total
               },
               chart_title: "Status de Alocação de Cotas",
               chart_options: {
                 library: {
                   legend: { display: true }
                 }
               } %>

    <%# Explanation:: This pie chart illustrates exactly which original applications provided
      #               the units for this redemption. It breaks down the withdrawal
      #               source to show how the "First-In, First-Out" rule was applied.
      %>
    <%= render "partials/groups/chart-list",
               chart_type: :pie_chart,
               data_source: allocation_by_app,
               chart_title: "Distribuição por Aplicação Original",
               chart_options: {
                 donut: true,
                 legend: "right",
                 library: {
                   plugins: {
                     legend: {
                       position: 'right'
                     }
                   }
                 }
               } %>
  <% end %>

  <%# Explanation:: This table provides a line-by-line audit of every investment application
    #               touched by this redemption. It allows the user to trace the origin
    #               of every unit back to its original purchase date and price.
    %>
  <%= render "partials/groups/table-list",
             section_title: "Alocações FIFO Detalhadas",
             collection: @redemption.redemption_allocations.includes(:application),
             action_path: nil,
             action_name: nil,
             headers: [
               "Aplicação Original",
               "Data da Aplicação",
               "Cotas Utilizadas",
               "Cotação na Aplicação",
               "Valor Original",
               "Percentual do Resgate"
             ],
             column_icons: [
               "briefcase",
               "calendar",
               "percent",
               "calculator",
               "banknote",
               "badge-percent"
             ],
             body_procs: [
               ->(alloc) { link_to("Aplicação ##{alloc.application.id}", application_path(alloc.application), class: "font-medium hover:underline") },
               ->(alloc) { formatted_timestamp(alloc.application.request_date) },
               ->(alloc) { colored_numerical(alloc.quotas_used, "h-auto") },
               ->(alloc) do
                 alloc.application.quota_value_at_application ? colored_currency(alloc.application.quota_value_at_application) : "N/A"
               end,
               ->(alloc) do
                 if alloc.quotas_used && alloc.application.quota_value_at_application
                   original_value = alloc.quotas_used * alloc.application.quota_value_at_application
                   colored_currency(original_value, "h-auto")
                 else
                   "N/A"
                 end
               end,
               ->(alloc) do
                 if @redemption.redeemed_quotas && @redemption.redeemed_quotas > 0
                   percentage = (alloc.quotas_used / @redemption.redeemed_quotas * 100)
                   colored_percentage(percentage, "h-auto")
                 else
                   "N/A"
                 end
               end
             ]
  %>

  <%# Explanation:: This section uses graphical comparisons to evaluate the growth or
    #               decay of the invested capital. It simplifies the analysis of
    #               gains by showing the original cost versus the final value.
    %>
  <%= render "partials/route/dashboard/section",
             section_title: "Análise de Rendimento",
             section_desc: "Comparação entre valor investido e resgatado",
             columns: 2 do
  %>

    <%# Explanation:: This bar chart compares the total money originally spent against
      #                the money received back. It provides a high-level view of
      #               performance to see if the investment met expectations.
      %>
    <%= render "partials/groups/chart-list",
               chart_type: :column_chart,
               data_source: {
                 "Valor Investido" => total_invested,
                 "Valor Resgatado" => redeemed_value
               },
               chart_title: "Investimento vs Resgate",
               chart_options: {
                 prefix: "R$ ",
                 thousands: ".",
                 decimal: ",",
                 colors: ["#6366f1", "#10b981"]
               } %>

    <%# Explanation:: This donut chart shows what portion of the final value is original
      #               capital versus profit. It highlights the actual earnings generated
      #               by the asset to help the user visualize their true growth.
      %>
    <%= render "partials/groups/chart-list",
               chart_type: :pie_chart,
               data_source: {
                 "Capital Inicial" => total_invested,
                 "Rendimento" => yield_value
               },
               chart_title: "Composição do Valor Resgatado",
               chart_options: {
                 prefix: "R$ ",
                 thousands: ".",
                 decimal: ",",
                 donut: true,
                 legend: "right"
               } %>
  <% end %>

  <%# Explanation:: This section performs automatic logic checks on the transaction data
    #               to detect errors. It flags inconsistent dates or unbalanced totals
    #               so the user can fix information before it affects financial reports.
    %>
  <%= render "partials/route/dashboard/section",
             columns: 2,
             has_action: false do
  %>

    <%# Explanation:: This group validates that all dates follow a logical chronological
      #               order. It ensures money is not "settled" before it was "requested,"
      #               protecting the integrity of the transaction's history.
      %>
    <%= render "partials/route/dashboard/section",
               section_title: "Validações de Data",
               columns: 1,
               has_action: false do
    %>

      <%# Explanation:: This card checks that the cotization date occurs after the request
        #               date. It verifies that the price was set only after the withdrawal
        #               was requested, maintaining the logical flow of operations.
        %>
      <%= render "partials/blocks/info-card",
                 title: "Cotização após Solicitação",
                 subtitle: cotization_valid ? "Válido" : "Inválido - data inconsistente",
                 main_value: cotization_valid ? "Ok!" : "Erro",
                 sub_value: cotization_valid ? "Cronologia correta" : "Requer correção",
                 icon_name: cotization_valid ? "check" : "x",
                 main_color: cotization_valid ? "success" : "danger"
      %>

      <%# Explanation:: This card ensures the final settlement happened only after the quota
        #               price was officially set. It prevents entries where payment
        #               precedes valuation, ensuring the audit trail remains correct.
        %>
      <%= render "partials/blocks/info-card",
                 title: "Liquidação após Cotização",
                 subtitle: liquidation_valid ? "Válido" : "Inválido - data inconsistente",
                 main_value: liquidation_valid ? "Ok!" : "Erro",
                 sub_value: liquidation_valid ? "Cronologia correta" : "Requer correção",
                 icon_name: liquidation_valid ? "check" : "x",
                 main_color: liquidation_valid ? "success" : "danger"
      %>
    <% end %>

    <%# Explanation:: This group verifies the mathematical integrity of the withdrawal by
      #               checking quota balances. It alerts the user if the units being
      #               removed exceed the units available in the portfolio.
      %>
    <%= render "partials/route/dashboard/section",
               section_title: "Validações Financeiras",
               columns: 1,
               has_action: false do
    %>

      <%# Explanation:: This card checks if the sum of all allocated quotas equals the
        #               total amount redeemed. It ensures the math behind the FIFO
        #               distribution is consistent and free of calculation errors.
        %>
      <%= render "partials/blocks/info-card",
                 title: "Balanço de Alocações",
                 subtitle: allocations_balanced ? "Total alocado = Total resgatado" : "Verificar discrepância",
                 main_value: allocations_balanced ? "Ok!" : "Divergente",
                 sub_value: allocations_balanced ? "Cotas balanceadas" : "Requer revisão",
                 icon_name: allocations_balanced ? "check" : "x",
                 main_color: allocations_balanced ? "success" : "danger"
      %>

      <%# Explanation:: This card confirms that the portfolio actually held enough quotas
        #               to satisfy the redemption request. It protects against "over-redeeming"
        #               and ensures the user's units never drop below a zero balance.
        %>
      <%= render "partials/blocks/info-card",
                 title: "Cotas Suficientes",
                 subtitle: sufficient_quotas ? "Dentro do saldo disponível" : "Verificar saldo",
                 main_value: sufficient_quotas ? "Ok!" : "Atenção",
                 sub_value: sufficient_quotas ? "Saldo adequado" : "Saldo insuficiente",
                 icon_name: sufficient_quotas ? "check" : "x",
                 main_color: sufficient_quotas ? "success" : "danger"
      %>
    <% end %>
  <% end %>

  <%# Explanation:: This section calculates high-level performance metrics such as average
    #               cost and appreciation. It provides a summary of the entire investment's
    #               success to help the user evaluate their financial strategy.
    %>
  <%= render "partials/route/dashboard/section",
             section_title: "Resumo de Performance",
             columns: 4,
             has_action: false do
  %>

    <%# Explanation:: This card shows the total original cost of all the units being
      #               withdrawn. It serves as the baseline for performance tracking
      #               and helps calculate the exact profit or loss of the operation.
      %>
    <%= render "partials/route/dashboard/card",
               card_title: "Capital Investido Total",
               card_icon: "dollar-sign" do
    %>
      <%= standard_currency(total_invested) %>
    <% end %>

    <%# Explanation:: This card presents the net financial gain or loss realized during
      #               this specific exit. It uses intuitive icons to show if the user
      #               successfully increased their wealth through this asset.
      %>
    <%= render "partials/route/dashboard/card",
               card_title: "Ganhos e Perdas Líquidas",
               card_icon: net_gain >= 0 ? "smile" : "frown",
               card_data: net_gain >= 0 ? "Lucro realizado" : "Prejuízo realizado",
               card_data_icon: net_gain >= 0 ? "trending-up" : "trending-down",
               is_success: net_gain >= 0,
               is_danger: net_gain < 0 do
    %>
      <%= net_gain >= 0 ? '+' : '' %><%= standard_currency(net_gain.abs) %>
    <% end %>

    <%# Explanation:: This card calculates the weighted average price paid for the units
      #               being redeemed. It is an essential metric for tax reporting and
      #               helps the user understand their entry point into the investment.
      %>
    <%= render "partials/route/dashboard/card",
               card_title: "Custo Médio da Cota",
               card_icon: "chart-bar-stacked" do
    %>
      <%= avg_quota_cost > 0 ? standard_currency(avg_quota_cost) : "N/A" %>
    <% end %>

    <%# Explanation:: This card displays the percentage growth of the quota value since
      #               the initial purchase. it shows how much the asset appreciated
      #               over time, providing a clear indicator of market success.
      %>
    <%= render "partials/route/dashboard/card",
               card_title: "Valorização da Cota",
               card_icon: "percent",
               card_data: appreciation ? "Comparativo" : "N/A",
               card_data_icon: "arrow-up-right" do
    %>
      <% if appreciation %>
        <%= appreciation >= 0 ? '+' : '' %><%= number_with_precision(appreciation, precision: 2) %>%
      <% else %>
        N/A
      <% end %>
    <% end %>
  <% end %>

  <%# Explanation:: This section provides the internal database timestamps for when the
    #               record was first saved and last edited. It gives the user an
    #               audit trail to see when the most recent updates were performed.
    %>
  <%= render "partials/route/dashboard/section",
             section_title: "Metadados do Sistema",
             columns: 2,
             has_action: false do
  %>

    <%# Explanation:: This card displays the exact date and time the redemption record
      #               was created in the system. It helps track the historical age
      #               of the transaction for administrative and auditing purposes.
      %>
    <%= render "partials/blocks/info-card",
               title: "Registro Criado",
               subtitle: formatted_timestamp(@redemption.created_at),
               main_value: "Há #{time_ago_in_words(@redemption.created_at)}",
               sub_value: "Data de criação",
               icon_name: "calendar-plus",
               main_color: "secondary"
    %>

    <%# Explanation:: This card shows the timestamp of the most recent change made to
      #               this record. It ensures the user knows they are looking at the
      #               latest version of the data saved in the application database.
      %>
    <%= render "partials/blocks/info-card",
               title: "Última Atualização",
               subtitle: formatted_timestamp(@redemption.updated_at),
               main_value: "Há #{time_ago_in_words(@redemption.updated_at)}",
               sub_value: "Modificação mais recente",
               icon_name: "refresh-cw",
               main_color: "secondary"
    %>
  <% end %>
<% end %>